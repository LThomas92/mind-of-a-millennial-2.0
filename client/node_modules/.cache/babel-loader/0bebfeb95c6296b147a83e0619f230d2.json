{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.INLINE_BUTTONS = exports.BLOCK_BUTTONS = undefined;\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _blocktoolbar = require('./blocktoolbar');\n\nvar _blocktoolbar2 = _interopRequireDefault(_blocktoolbar);\n\nvar _inlinetoolbar = require('./inlinetoolbar');\n\nvar _inlinetoolbar2 = _interopRequireDefault(_inlinetoolbar);\n\nvar _index = require('../util/index');\n\nvar _index2 = require('../model/index');\n\nvar _constants = require('../util/constants');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n} // import './toolbar.scss';\n\n\nvar Toolbar = function (_React$Component) {\n  _inherits(Toolbar, _React$Component);\n\n  function Toolbar(props) {\n    _classCallCheck(this, Toolbar);\n\n    var _this = _possibleConstructorReturn(this, (Toolbar.__proto__ || Object.getPrototypeOf(Toolbar)).call(this, props));\n\n    _this.state = {\n      showURLInput: false,\n      urlInputValue: ''\n    };\n    _this.onKeyDown = _this.onKeyDown.bind(_this);\n    _this.onChange = _this.onChange.bind(_this);\n    _this.handleLinkInput = _this.handleLinkInput.bind(_this);\n    _this.hideLinkInput = _this.hideLinkInput.bind(_this);\n    return _this;\n  }\n\n  _createClass(Toolbar, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(newProps) {\n      var editorState = newProps.editorState;\n\n      if (!newProps.editorEnabled) {\n        return;\n      }\n\n      var selectionState = editorState.getSelection();\n\n      if (selectionState.isCollapsed()) {\n        if (this.state.showURLInput) {\n          this.setState({\n            showURLInput: false,\n            urlInputValue: ''\n          });\n        }\n\n        return;\n      }\n    } // shouldComponentUpdate(newProps, newState) {\n    //   console.log(newState, this.state);\n    //   if (newState.showURLInput !== this.state.showURLInput && newState.urlInputValue !== this.state.urlInputValue) {\n    //     return true;\n    //   }\n    //   return false;\n    // }\n\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      if (!this.props.editorEnabled || this.state.showURLInput) {\n        return;\n      }\n\n      var selectionState = this.props.editorState.getSelection();\n\n      if (selectionState.isCollapsed()) {\n        return;\n      } // eslint-disable-next-line no-undef\n\n\n      var nativeSelection = (0, _index.getSelection)(window);\n\n      if (!nativeSelection.rangeCount) {\n        return;\n      }\n\n      var selectionBoundary = (0, _index.getSelectionRect)(nativeSelection); // eslint-disable-next-line react/no-find-dom-node\n\n      var toolbarNode = _reactDom2.default.findDOMNode(this);\n\n      var toolbarBoundary = toolbarNode.getBoundingClientRect(); // eslint-disable-next-line react/no-find-dom-node\n\n      var parent = _reactDom2.default.findDOMNode(this.props.editorNode);\n\n      var parentBoundary = parent.getBoundingClientRect();\n      /*\n      * Main logic for setting the toolbar position.\n      */\n\n      toolbarNode.style.top = selectionBoundary.top - parentBoundary.top - toolbarBoundary.height - 5 + 'px';\n      toolbarNode.style.width = toolbarBoundary.width + 'px'; // The left side of the tooltip should be:\n      // center of selection relative to parent - half width of toolbar\n\n      var selectionCenter = selectionBoundary.left + selectionBoundary.width / 2 - parentBoundary.left;\n      var left = selectionCenter - toolbarBoundary.width / 2;\n      var screenLeft = parentBoundary.left + left;\n\n      if (screenLeft < 0) {\n        // If the toolbar would be off-screen\n        // move it as far left as it can without going off-screen\n        left = -parentBoundary.left;\n      }\n\n      toolbarNode.style.left = left + 'px';\n    }\n  }, {\n    key: 'onKeyDown',\n    value: function onKeyDown(e) {\n      if (e.which === 13) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.props.setLink(this.state.urlInputValue);\n        this.hideLinkInput();\n      } else if (e.which === 27) {\n        this.hideLinkInput();\n      }\n    }\n  }, {\n    key: 'onChange',\n    value: function onChange(e) {\n      this.setState({\n        urlInputValue: e.target.value\n      });\n    }\n  }, {\n    key: 'handleLinkInput',\n    value: function handleLinkInput(e) {\n      var _this2 = this;\n\n      var direct = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (direct !== true) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      var editorState = this.props.editorState;\n      var selection = editorState.getSelection();\n\n      if (selection.isCollapsed()) {\n        this.props.focus();\n        return;\n      }\n\n      var currentBlock = (0, _index2.getCurrentBlock)(editorState);\n      var selectedEntity = '';\n      var linkFound = false;\n      currentBlock.findEntityRanges(function (character) {\n        var entityKey = character.getEntity();\n        selectedEntity = entityKey;\n        return entityKey !== null && editorState.getCurrentContent().getEntity(entityKey).getType() === _constants.Entity.LINK;\n      }, function (start, end) {\n        var selStart = selection.getAnchorOffset();\n        var selEnd = selection.getFocusOffset();\n\n        if (selection.getIsBackward()) {\n          selStart = selection.getFocusOffset();\n          selEnd = selection.getAnchorOffset();\n        }\n\n        if (start === selStart && end === selEnd) {\n          linkFound = true;\n\n          var _editorState$getCurre = editorState.getCurrentContent().getEntity(selectedEntity).getData(),\n              url = _editorState$getCurre.url;\n\n          _this2.setState({\n            showURLInput: true,\n            urlInputValue: url\n          }, function () {\n            setTimeout(function () {\n              _this2.urlinput.focus();\n\n              _this2.urlinput.select();\n            }, 0);\n          });\n        }\n      });\n\n      if (!linkFound) {\n        this.setState({\n          showURLInput: true\n        }, function () {\n          setTimeout(function () {\n            _this2.urlinput.focus();\n          }, 0);\n        });\n      }\n    }\n  }, {\n    key: 'hideLinkInput',\n    value: function hideLinkInput() {\n      var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (e !== null) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      this.setState({\n        showURLInput: false,\n        urlInputValue: ''\n      }, this.props.focus);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props = this.props,\n          editorState = _props.editorState,\n          editorEnabled = _props.editorEnabled,\n          inlineButtons = _props.inlineButtons;\n      var _state = this.state,\n          showURLInput = _state.showURLInput,\n          urlInputValue = _state.urlInputValue;\n      var isOpen = true;\n\n      if (!editorEnabled || editorState.getSelection().isCollapsed()) {\n        isOpen = false;\n      }\n\n      if (showURLInput) {\n        var className = 'md-editor-toolbar' + (isOpen ? ' md-editor-toolbar--isopen' : '');\n        className += ' md-editor-toolbar--linkinput';\n        return _react2.default.createElement('div', {\n          className: className\n        }, _react2.default.createElement('div', {\n          className: 'md-RichEditor-controls md-RichEditor-show-link-input',\n          style: {\n            display: 'block'\n          }\n        }, _react2.default.createElement('span', {\n          className: 'md-url-input-close',\n          onClick: this.hideLinkInput\n        }, '\\xD7'), _react2.default.createElement('input', {\n          ref: function ref(node) {\n            _this3.urlinput = node;\n          },\n          type: 'text',\n          className: 'md-url-input',\n          onKeyDown: this.onKeyDown,\n          onChange: this.onChange,\n          placeholder: 'Press ENTER or ESC',\n          value: urlInputValue\n        })));\n      }\n\n      var hasHyperLink = false;\n      var hyperlinkLabel = '#';\n      var hyperlinkDescription = 'Add a link';\n\n      for (var cnt = 0; cnt < inlineButtons.length; cnt++) {\n        if (inlineButtons[cnt].style === _constants.HYPERLINK) {\n          hasHyperLink = true;\n\n          if (inlineButtons[cnt].label) {\n            hyperlinkLabel = inlineButtons[cnt].label;\n          }\n\n          if (inlineButtons[cnt].description) {\n            hyperlinkDescription = inlineButtons[cnt].description;\n          }\n\n          break;\n        }\n      }\n\n      return _react2.default.createElement('div', {\n        className: 'md-editor-toolbar' + (isOpen ? ' md-editor-toolbar--isopen' : '')\n      }, this.props.blockButtons.length > 0 ? _react2.default.createElement(_blocktoolbar2.default, {\n        editorState: editorState,\n        onToggle: this.props.toggleBlockType,\n        buttons: this.props.blockButtons\n      }) : null, this.props.inlineButtons.length > 0 ? _react2.default.createElement(_inlinetoolbar2.default, {\n        editorState: editorState,\n        onToggle: this.props.toggleInlineStyle,\n        buttons: this.props.inlineButtons\n      }) : null, hasHyperLink && _react2.default.createElement('div', {\n        className: 'md-RichEditor-controls'\n      }, _react2.default.createElement('span', {\n        className: 'md-RichEditor-styleButton md-RichEditor-linkButton hint--top',\n        onClick: this.handleLinkInput,\n        'aria-label': hyperlinkDescription\n      }, hyperlinkLabel)));\n    }\n  }]);\n\n  return Toolbar;\n}(_react2.default.Component);\n\nToolbar.propTypes = {\n  editorEnabled: _propTypes2.default.bool,\n  editorState: _propTypes2.default.object,\n  toggleBlockType: _propTypes2.default.func,\n  toggleInlineStyle: _propTypes2.default.func,\n  inlineButtons: _propTypes2.default.arrayOf(_propTypes2.default.object),\n  blockButtons: _propTypes2.default.arrayOf(_propTypes2.default.object),\n  editorNode: _propTypes2.default.object,\n  setLink: _propTypes2.default.func,\n  focus: _propTypes2.default.func\n};\nToolbar.defaultProps = {\n  blockButtons: BLOCK_BUTTONS,\n  inlineButtons: INLINE_BUTTONS\n};\nexports.default = Toolbar;\nvar BLOCK_BUTTONS = exports.BLOCK_BUTTONS = [{\n  label: 'H3',\n  style: 'header-three',\n  icon: 'header',\n  description: 'Heading 3'\n}, {\n  label: _react2.default.createElement('svg', {\n    width: '10.83',\n    height: '10',\n    viewBox: '0 0 13 12'\n  }, _react2.default.createElement('g', {\n    stroke: 'none',\n    strokeWidth: '1',\n    fill: 'none',\n    fillRule: 'evenodd'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(-357.000000, -255.000000)',\n    fill: '#FFFFFF'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(260.000000, 165.000000)'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(0.000000, 75.000000)'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(19.000000, 0.000000)'\n  }, _react2.default.createElement('path', {\n    d: 'M90.500768,15 L91,15.56 C88.9631235,17.0533408 87.9447005,18.666658 87.9447005,20.4 C87.9447005,21.8800074 88.75012,23.1466614 90.3609831,24.2 L87.5453149,27 C85.9211388,25.7866606 85.109063,24.346675 85.109063,22.68 C85.109063,20.3199882 86.90628,17.7600138 90.500768,15 Z M83.3917051,15 L83.890937,15.56 C81.8540605,17.0533408 80.8356375,18.666658 80.8356375,20.4 C80.8356375,21.8800074 81.6344006,23.1466614 83.2319508,24.2 L80.4362519,27 C78.8120759,25.7866606 78,24.346675 78,22.68 C78,20.3199882 79.7972171,17.7600138 83.3917051,15 Z'\n  }))))))),\n  style: 'blockquote',\n  icon: 'quote-right',\n  description: 'Blockquote'\n}, {\n  label: 'UL',\n  style: 'unordered-list-item',\n  icon: 'list-ul',\n  description: 'Unordered List'\n}, {\n  label: 'OL',\n  style: 'ordered-list-item',\n  icon: 'list-ol',\n  description: 'Ordered List'\n}, {\n  label: '✓',\n  style: 'todo',\n  description: 'Todo List'\n}];\nvar INLINE_BUTTONS = exports.INLINE_BUTTONS = [{\n  label: 'B',\n  style: 'BOLD',\n  icon: 'bold',\n  description: 'Bold'\n}, {\n  label: 'I',\n  style: 'ITALIC',\n  icon: 'italic',\n  description: 'Italic'\n}, {\n  label: 'U',\n  style: 'UNDERLINE',\n  icon: 'underline',\n  description: 'Underline'\n}, {\n  label: 'Hi',\n  style: 'HIGHLIGHT',\n  description: 'Highlight selection'\n}, {\n  label: _react2.default.createElement('svg', {\n    width: '20',\n    height: '15',\n    viewBox: '0 0 14 14'\n  }, _react2.default.createElement('g', {\n    stroke: 'none',\n    strokeWidth: '1',\n    fill: 'none',\n    fillRule: 'evenodd'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(-468.000000, -254.000000)',\n    stroke: '#FFFFFF'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(260.000000, 165.000000)'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(0.000000, 75.000000)'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(19.000000, 0.000000)'\n  }, _react2.default.createElement('g', {\n    transform: 'translate(196.424621, 21.424621) rotate(45.000000) translate(-196.424621, -21.424621) translate(193.424621, 13.924621)'\n  }, _react2.default.createElement('path', {\n    d: 'M0.5,5.69098301 L0.5,2 C0.5,1.82069363 0.550664909,1.51670417 0.697213595,1.2236068 C0.927818928,0.762396132 1.32141313,0.5 2,0.5 L4,0.5 C4.67858687,0.5 5.07218107,0.762396132 5.3027864,1.2236068 C5.44933509,1.51670417 5.5,1.82069363 5.5,2 L5.5,6 C5.5,6.67858687 5.23760387,7.07218107 4.7763932,7.3027864 C4.53586606,7.42304998 4.28800365,7.47874077 4.1077327,7.49484936 L0.5,5.69098301 Z'\n  }), _react2.default.createElement('path', {\n    d: 'M0.5,12.690983 L0.5,9 C0.5,8.82069363 0.550664909,8.51670417 0.697213595,8.2236068 C0.927818928,7.76239613 1.32141313,7.5 2,7.5 L4,7.5 C4.67858687,7.5 5.07218107,7.76239613 5.3027864,8.2236068 C5.44933509,8.51670417 5.5,8.82069363 5.5,9 L5.5,13 C5.5,13.6785869 5.23760387,14.0721811 4.7763932,14.3027864 C4.53586606,14.42305 4.28800365,14.4787408 4.1077327,14.4948494 L0.5,12.690983 Z',\n    transform: 'translate(3.000000, 11.000000) scale(-1, -1) translate(-3.000000, -11.000000) '\n  })))))))),\n  style: _constants.HYPERLINK,\n  icon: 'link',\n  description: 'Add a link'\n}];","map":null,"metadata":{},"sourceType":"script"}