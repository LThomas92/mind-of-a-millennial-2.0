{"ast":null,"code":"\"use strict\";\n\nvar nodeType = require(\"../node-type.js\");\n\nvar FocusEvent = require(\"../generated/FocusEvent.js\");\n\nvar idlUtils = require(\"../generated/utils.js\");\n\nvar _require = require(\"./form-controls.js\"),\n    isDisabled = _require.isDisabled;\n\nvar _require2 = require(\"./namespaces\"),\n    HTML_NS = _require2.HTML_NS;\n\nvar focusableFormElements = new Set([\"input\", \"select\", \"textarea\", \"button\"]); // https://html.spec.whatwg.org/multipage/interaction.html#focusable-area, but also some of\n// https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps: e.g., Documents are not actually focusable\n// areas, but their viewports are, and the first step of the latter algorithm translates Documents to their viewports.\n// And also https://html.spec.whatwg.org/multipage/interaction.html#specially-focusable!\n\nexports.isFocusableAreaElement = function (elImpl) {\n  if (!elImpl._ownerDocument._defaultView && !elImpl._defaultView) {\n    return false;\n  }\n\n  if (elImpl._nodeType === nodeType.DOCUMENT_NODE) {\n    return true;\n  }\n\n  if (!Number.isNaN(parseInt(elImpl.getAttribute(\"tabindex\")))) {\n    return true;\n  }\n\n  if (elImpl._namespaceURI === HTML_NS) {\n    if (elImpl._localName === \"iframe\") {\n      return true;\n    }\n\n    if (elImpl._localName === \"a\" && elImpl.hasAttribute(\"href\")) {\n      return true;\n    }\n\n    if (focusableFormElements.has(elImpl._localName) && !isDisabled(elImpl)) {\n      if (elImpl._localName === \"input\" && elImpl.type === \"hidden\") {\n        return false;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}; // https://html.spec.whatwg.org/multipage/interaction.html#fire-a-focus-event plus the steps of\n// https://html.spec.whatwg.org/multipage/interaction.html#focus-update-steps that adjust Documents to Windows\n\n\nexports.fireFocusEventWithTargetAdjustment = function (name, target, relatedTarget) {\n  if (target === null) {\n    // E.g. firing blur with nothing previously focused.\n    return;\n  }\n\n  var event = FocusEvent.createImpl([name, {\n    bubbles: false,\n    cancelable: false,\n    relatedTarget: relatedTarget,\n    view: target._ownerDocument._defaultView,\n    detail: 0\n  }], {\n    isTrusted: true\n  });\n\n  if (target._defaultView) {\n    target = idlUtils.implForWrapper(target._defaultView);\n  } // _dispatch allows setting isTrusted\n\n\n  target._dispatch(event);\n};","map":null,"metadata":{},"sourceType":"script"}