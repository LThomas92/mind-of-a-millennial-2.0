{"ast":null,"code":"\"use strict\";\n\nvar _require = require(\"../utils\"),\n    isValidTargetOrigin = _require.isValidTargetOrigin;\n\nvar DOMException = require(\"domexception\");\n\nmodule.exports = function (message, targetOrigin) {\n  var _this = this;\n\n  if (arguments.length < 2) {\n    throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n  }\n\n  targetOrigin = String(targetOrigin);\n\n  if (!isValidTargetOrigin(targetOrigin)) {\n    throw new DOMException(\"Failed to execute 'postMessage' on 'Window': \" + \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\", \"SyntaxError\");\n  } // TODO: targetOrigin === '/' - requires reference to source window\n  // See https://github.com/tmpvar/jsdom/pull/1140#issuecomment-111587499\n\n\n  if (targetOrigin !== \"*\" && targetOrigin !== this.location.origin) {\n    return;\n  } // TODO: event.source - requires reference to source window\n  // TODO: event.origin - requires reference to source window\n  // TODO: event.ports\n  // TODO: event.data - structured clone message - requires cloning DOM nodes\n\n\n  var event = new this.MessageEvent(\"message\", {\n    data: message\n  });\n  event.initEvent(\"message\", false, false);\n  setTimeout(function () {\n    _this.dispatchEvent(event);\n  }, 0);\n};","map":null,"metadata":{},"sourceType":"script"}